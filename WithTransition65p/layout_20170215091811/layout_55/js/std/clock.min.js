$(document).ready(function(){});
var clock={idArray:[],clockInIframe:!1,bInited:[],now:(new Date).getTime(),blink:"",color:"",bgcolor:"",fontsize:"",sec:[],hour12:[],align:[],pageScreenWidth:[],pageScreenHieght:[],autofit:[],dateFormat:[],timeFormat:[],monthNames:"January February March April May June July August September October November December".split(" "),dayNames_en:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),dayNames_zh:"\u661f\u671f\u65e5 \u661f\u671f\u4e00 \u661f\u671f\u4e8c \u661f\u671f\u4e09 \u661f\u671f\u56db \u661f\u671f\u4e94 \u661f\u671f\u516d".split(" "),systemTimeIntrvalHandle:null,
oldDate:0,startCheckDate:!1,ntp:"",checkntpjson:null,render:function(){1==clock.clockInIframe&&("number"==typeof window.innerWidth?(pageScreenWidth=window.innerWidth,pageScreenHieght=window.innerHeight):"number"==typeof window.innerWidth?(pageScreenWidth=document.documentElement.clientWidth,pageScreenHieght=document.documentElement.clientHeight):(pageScreenWidth=document.body.offsetWidth,pageScreenHieght=document.body.offsetHeight),clock.pageScreenWidth=pageScreenWidth,clock.pageScreenHieght=pageScreenHieght,
clock.geturlparameter(),clock.renderInIframe());clock.systemTimeIntrvalHandle=setInterval(function(){clock.now=(new Date).getTime()},500);$(".digiclock").each(function(a){var b=$(this).attr("id");clock.idArray[a]=b;clock.sec[b]=!1;clock.hour12[b]=!1;clock.getParameterFromAttribute(b);null!=clock.dateFormat[b]&&(clock.dateFormat[b]=clock.checkDateFormat(clock.dateFormat[b]));null!=clock.timeFormat[b]&&(clock.timeFormat[b]=clock.checkTimeFormat(clock.timeFormat[b]));"true"==clock.autofit[b]&&clock.renderInDiv(b);
clock.genFormat(b,clock.dateFormat[b],clock.timeFormat[b],clock.now);clock.bInited[b]=!1;"true"==clock.ntp?(ntpjson.nowCallbackFun=clock.setNow,null==clock.checkntpjson&&(clock.checkntpjson=setInterval(function(a){return function(){if(1==ntpjson.isInited){clearInterval(clock.checkntpjson);clearInterval(clock.systemTimeIntrvalHandle);for(var a=0;a<clock.idArray.length;a++)clock.init(clock.idArray[a])}}}(0),100))):clock.init(b)});"true"==clock.ntp&&(ntpjson.getTimeZoneFromServer(),setInterval(function(){ntpjson.bTickerStart=
!1;ntpjson.getTimeZoneFromServer()},432E5))},setNow:function(a){clock.now=a},getParameterFromAttribute:function(a){console.log($("#"+a));clock.dateFormat[a]=$("#"+a).attr("dateFormat");clock.timeFormat[a]=$("#"+a).attr("timeFormat");clock.autofit[a]="true"==$("#"+a).attr("autofit")?"true":"false";""==clock.ntp&&"true"==$("#"+a).attr("ntp")&&(clock.ntp="true")},renderInDiv:function(a){clock.pageScreenHieght[a]=parseInt($("#"+a).parent().css("height"));clock.pageScreenWidth[a]=parseInt($("#"+a).parent().css("width"));
console.log("pageScreenHieght1="+clock.pageScreenHieght[a]);null!=clock.dateFormat[a]&&clock.dateFormat[a].match(/enx/i)||null!=clock.timeFormat[a]&&clock.timeFormat[a].match(/enx/i);clock.pageScreenWidth[a]-=2;console.log("pageScreenWidth="+clock.pageScreenWidth[a]);console.log("pageScreenHieght2="+clock.pageScreenHieght[a]);$("#"+a).css("font-size",clock.pageScreenHieght[a]+"px")},geturlparameter:function(){var a=document.location.href;console.log("url="+a);clock.fontsize=clock.getParameterFromURL(a,
"fontsize");clock.dateFormat=clock.getParameterFromURL(a,"dateFormat");clock.timeFormat=clock.getParameterFromURL(a,"timeFormat");clock.autofit=clock.getParameterFromURL(a,"autofit");clock.blink=clock.getParameterFromURL(a,"blink");clock.color=clock.getParameterFromURL(a,"color");clock.bgcolor=clock.getParameterFromURL(a,"bgcolor");clock.ntp=clock.getParameterFromURL(a,"ntp");clock.align=clock.getParameterFromURL(a,"align");"true"!=clock.blink&&$(".digiclock_point").removeClass("digiclock_pointhide").addClass("digiclock_pointshow")},
renderInIframe:function(){null!=clock.color?$(".clock").css("color",clock.color):$(".clock").css("color","#111111");null!=clock.bgcolor?$("body").css("background-color",clock.bgcolor):$("body").css("background-color","transparent");"right"==clock.align?$(".clock").css("textAlign","right"):"center"==clock.align&&$(".clock").css("textAlign","center");console.log("pageScreenHieght1="+pageScreenHieght);null!=clock.dateFormat&&clock.dateFormat.match(/enx/i)||null!=clock.timeFormat&&clock.timeFormat.match(/enx/i)?
clock.pageScreenHieght*=.83:clock.pageScreenHieght*=.93;clock.pageScreenWidth-=2;console.log("pageScreenWidth="+clock.pageScreenWidth);console.log("pageScreenHieght2="+clock.pageScreenHieght);$(".clock").css("width",clock.pageScreenWidth);$(".clock").css("height",clock.pageScreenHieght);$(".digiclock").css("font-size",clock.pageScreenHieght+"px")},genFormat:function(a,b,c,f){console.log("dateFormat="+b+";timeFormat="+c);var d="";0==$("#"+a).find(".digiclock_wrapper").length&&$("#"+a).html('<span class="digiclock_wrapper"></span>');
$("#"+a).find(".digiclock_wrapper").html(d);null!=b&&""!=b&&(d+='<span id="datetime_date" class="digiclock_init"></span>');null!=b&&""!=b&&null!=c&&""!=c&&(d+='<span id="datetime_spaces" class="digiclock_init">&nbsp;&nbsp;&nbsp;</span>');null!=c&&""!=c&&(d+='<span id="datetime_time" class="digiclock_init"></span>');$("#"+a).find(".digiclock_wrapper").html(d);null!=b&&""!=b&&clock.genDate(a,b,f);null!=c&&""!=c&&clock.genTime(a,c,f)},checkDateFormat:function(a){zh_dateFormat1="YYYY-MM-DD";zh_dateFormat2=
"YYYY\u5e74MM\u6708DD\u65e5";zh_dateFormat3="YYYY\u5e74MM\u6708DD\u65e5 WWZH";zh_dateFormat4="YYYY/MM/DD";zh_dateFormat5="DD/MM/YYYY";en_dateFormat1="DD/MM";en_dateFormat2="MM/DD";en_dateFormat3="DD/MM/YY";en_dateFormat4="MM/DD/YY";enx_dateFormat5="WWENX, MMENX DD, YYYY";console.log("--------------------\x3e");a.match("dateFormat")&&(console.log(typeof eval(a)),a=eval(a));return a},genDate:function(a,b,c){c=new Date(c);b=b.replace("YYYY",c.getFullYear());b=b.replace("YY",Math.floor(c.getFullYear()/
100));b=b.replace("MMENX",clock.monthNames[c.getMonth()]);b=b.replace("MM",10>c.getMonth()+1?"0"+(c.getMonth()+1):c.getMonth()+1);b=b.replace("M",c.getMonth()+1);b=b.replace("DD",10>c.getDate()?"0"+c.getDate():c.getDate());b=b.replace("WWENX",clock.dayNames_en[c.getDay()]);b=b.replace("WWZH",clock.dayNames_zh[c.getDay()]);$("#"+a).find("#datetime_date").html(b)},checkTimeFormat:function(a){timeFormat1="HH:MM:SS";timeFormat2="HH:MM";timeFormat3="AA HH:MM";timeFormat4="AA HH:MM:SS";timeFormat5="HH:MM AA";
timeFormat6="HH:MM:SS AA";console.log("--------------------\x3e");a.match("timeFormat")&&(console.log(typeof eval(a)),a=eval(a));return a},genTime:function(a,b,c){c=b;b.match("SS")&&(clock.sec[a]=!0);b.match("AA")&&(clock.hour12[a]=!0);c=c.replace("SS",'<span id="datetime_sec" class="digiclock_init">08</span>');c=c.replace("HH",'<span id="datetime_hours" class="digiclock_init" >08</span>');c=c.replace("MM",'<span id="datetime_min" class="digiclock_init">08</span>');c=c.replace("AA",'<span id="datetime_ampm" class="digiclock_init" >AM</span>');
c=c.replace(/:/g,'<span id="point" class=" digiclock_point digiclock_init">:</span>');$("#"+a).find("#datetime_time").html(c)},urlParams:null,urlparser:function(a){var b,c=/\+/g,f=/([^&=]+)=?([^&]*)/g;for(this.urlParams={};b=f.exec(a);)this.urlParams[decodeURIComponent(b[1].replace(c," "))]=decodeURIComponent(b[2].replace(c," "))},getParameterFromURL:function(a,b){if(null==this.urlParams){var c=a.substring(a.indexOf("?")+1);this.urlparser(c)}return this.urlParams[b]},init:function(a){console.log("id5="+
a);1!=clock.bInited[a]&&(console.log("--------\x3einit!"),clock.bInited[a]=!0,clock.genFormat(a,clock.dateFormat[a],clock.timeFormat[a],clock.now),"false"==clock.autofit[a]?(clock.start(a),setTimeout(function(a){return function(){if(0==parseInt($("#"+a).find(".digiclock_wrapper").css("height"))){var c=0;$("#"+a).find(".digiclock_wrapper").find("span").each(function(){parseInt($(this).css("height"))>c&&(c=parseInt($(this).css("height")))});var f=c-parseInt($("#"+a).parent().css("height"))}else f=parseInt($("#"+
a).find(".digiclock_wrapper").css("height"))-parseInt($("#"+a).parent().css("height"));$("#"+a).css("padding-top",-1*f/2+"px")}}(a),10)):setTimeout(function(a){return function(){function c(a){digiwidth=$("#"+a).find(".digiclock_wrapper").width();digiwidth>f&&(f=digiwidth+5);e==parseInt($("#"+a).css("font-size"))&&(d++,50<d&&(console.log("Reach size stable"),clearInterval(g),clock.start(a),setTimeout(function(){if(0==parseInt($("#"+a).find(".digiclock_wrapper").css("height"))){var b=0;$("#"+a).find(".digiclock_wrapper").find("span").each(function(){parseInt($(this).css("height"))>
b&&(b=parseInt($(this).css("height")))});var c=b-clock.pageScreenHieght[a]}else c=parseInt($("#"+a).find(".digiclock_wrapper").css("height"))-clock.pageScreenHieght[a];$("#"+a).css("padding-top",-1*c/2+"px")},10)));e=parseInt($("#"+a).css("font-size"));if(f>clock.pageScreenWidth[a]){var b=parseInt($("#"+a).css("font-size"));$("#"+a).css("font-size",b-2+"px");f=0}}var f=0,d=0,e=0,g=setInterval(function(a){return function(){c(a)}}(a),10)}}(a),500))},start:function(a){clock.genDate(a,clock.dateFormat[a],
new Date(clock.now));setTimeout(function(a){return function(){var c=0;timeinterval=1==clock.sec[a]?200:1E3;setInterval(function(){var c=new Date(clock.now),d=clock.now,e=c.getSeconds();$("#"+a).find("#datetime_sec").html((10>e?"0":"")+e);e=c.getMinutes();$("#"+a).find("#datetime_min").html((10>e?"0":"")+e);e=c.getHours();if(1==clock.hour12[a]){if(12<=e&&24>e){var g=e;12<g&&(g=e-12);$("#"+a).find("#datetime_ampm").html("PM")}else g=e,0==g&&(g=12),$("#"+a).find("#datetime_ampm").html("AM");$("#"+a).find("#datetime_hours").html((10>
g?"0":"")+g)}else $("#"+a).find("#datetime_hours").html((10>e?"0":"")+e);setTimeout(function(a){return function(){clock.oldDate[a]=c.getFullYear()+""+c.getMonth()+""+c.getDate();clock.startCheckDate=!0}}(a),1E4);1==clock.startCheckDate&&(e=c.getFullYear()+""+c.getMonth()+""+c.getDate(),clock.oldDate[a]!=e&&clock.genDate(a,clock.dateFormat[a],d))},1E3);"true"==clock.blink&&setInterval(function(){1==c?($(".digiclock_point").each(function(){$(this).removeClass("digiclock_pointhide").addClass("digiclock_pointshow")}),
c=0):($(".digiclock_point").each(function(){$(this).removeClass("digiclock_pointshow").addClass("digiclock_pointhide")}),c=1)},500);setTimeout(function(a){return function(){$("#"+a).find(".digiclock_wrapper").find("span").each(function(){$(this).removeClass("digiclock_init")})}}(a),1E3)}}(a),100)}},ntpjson={timediff:0,gtimezone:0,currentTimeOffsetFromServer:0,bTickerStart:!1,offset:0,now:0,nowCallbackFun:null,isInited:!1,getOffset:function(a){function b(a,b){for(var d=""+a;d.length<b;)d="0"+d;return d}
a=(new Date(ntpjson.now)).getTimezoneOffset();a=(0>a?"+":"-")+b(parseInt(Math.abs(a/60)),2)+b(Math.abs(a%60),2);console.log(a);return a},getTimeZoneFromServer:function(){$.ajaxSetup({timeout:5E3});$.timezone=function(a){$.get("http://www.telize.com/geoip?callback=?",function(b){a(b)},"json").fail(function(a){ntpjson.now=(new Date).getTime();ntpjson.isInited=!0})};$.timezone(function(a){ntpjson.currentTimeOffsetFromServer=a.offset;console.log("timezone="+a.timezone);ntpjson.gtimezone=a.timezone;ntpjson.getUTCtimeFromJsontestCom()})},
getUTCtimeFromJsontestCom:function(){$.ajax({type:"GET",url:"http://date.jsontest.com/",dataType:"json",timeout:5E3,success:function(a){console.log(a);var b=new Date(a.milliseconds_since_epoch);ntpjson.offset=ntpjson.getOffset(b.getTime());a=(new Date).getTime();b=b.getTime();ntpjson.timediff=b-a;ntpjson.TickerStart();ntpjson.isInited=!0;console.log("now="+ntpjson.now)},error:function(a){console.log(a)},complete:function(a){console.log(a)}})},getUTCtimeFromNTPserver:function(){$.data=function(a){$.get("http://json-time.appspot.com/time.json?callback=?",
function(b){a(new Date(b.datetime))},"json").fail(function(a){console.log("fail! next");ntpjson.isInited=!0})};$.data(function(a){console.log("time="+a);ntpjson.offset=ntpjson.getOffset(a.getTime());var b=(new Date).getTime();a=a.getTime();ntpjson.timediff=a-b;ntpjson.TickerStart();ntpjson.isInited=!0;console.log("now="+ntpjson.now)})},TickerStart:function(){1==ntpjson.bTickerStart?console.log("Ticker has been started"):(ntpjson.bTickerStart=!0,ntpjson.nowCallbackFun(ntpjson.now),console.log("-----------------------\x3eTickerStart!!"),
setInterval(function(){ntpjson.now=(new Date).getTime()+ntpjson.timediff+36E5*ntpjson.currentTimeOffsetFromServer-36E5*parseInt(ntpjson.offset/100)-6E4*parseInt(ntpjson.offset%100);ntpjson.nowCallbackFun(ntpjson.now)},500))}};
